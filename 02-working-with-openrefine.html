<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>OpenRefine for Social Science Data: Working with OpenRefine</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [ ['$','$'], ['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png"><link rel="manifest" href="site.webmanifest"><link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"></head><body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav data"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Data Carpentry" src="assets/images/data-logo.svg"></div>
    </div>
    <div class="selector-container ">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/02-working-with-openrefine.html';">Instructor View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav data" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Data Carpentry" src="assets/images/data-logo-sm.svg"></div>
    <div class="lesson-title-md">
      OpenRefine for Social Science Data
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
      <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            OpenRefine for Social Science Data
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="reference.html">Glossary</a></li>
          </ul></li>
      </ul></div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled><input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset></form>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  OpenRefine for Social Science Data
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 8%" class="percentage">
    8%
  </div>
  <div class="progress data">
    <div class="progress-bar data" role="progressbar" style="width: 8%" aria-valuenow="8" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
  <div id="sidebar-col" class="col-lg-4">
    <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle"><i class="search-icon" data-feather="x" role="img"></i></button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/02-working-with-openrefine.html">Instructor View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->
      
            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-introduction.html">1. Introduction</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        2. Working with OpenRefine
        </span>
      </button>
    </div><!--/div.accordion-header-->
        
    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#creating-a-new-openrefine-project">Creating a new OpenRefine project</a></li>
<li><a href="#using-facets">Using Facets</a></li>
<li><a href="#using-clustering-to-detect-possible-typing-errors">Using clustering to detect possible typing errors</a></li>
<li><a href="#transforming-data">Transforming data</a></li>
<li><a href="#using-undo-and-redo">Using undo and redo</a></li>
<li><a href="#trim-leading-and-trailing-whitespace">Trim Leading and Trailing Whitespace</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-filter-sort.html">3. Filtering and Sorting with OpenRefine</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-numbers.html">4. Examining Numbers in OpenRefine</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05-scripts.html">5. Using scripts</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-saving.html">6. Exporting and Saving Data from OpenRefine</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="07-resources.html">7. Other Resources in OpenRefine</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="reference.html">Glossary</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width resources"><a href="aio.html">See all in one page</a>

            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">
            
            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="01-introduction.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="03-filter-sort.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="01-introduction.html" rel="prev"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous: Introduction</a>
        <a class="chapter-link float-end" href="03-filter-sort.html" rel="next">Next: Filtering and... <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Working with OpenRefine</h1>
        <p> Last updated on 2023-06-12 | 
        
        <a href="https://github.com/datacarpentry/openrefine-socialsci/edit/main/episodes/02-working-with-openrefine.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
        
        
        
        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How can we bring our data into OpenRefine?</li>
<li>How can we sort and summarize our data?</li>
<li>How can we find and correct errors in our raw data?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Create a new OpenRefine project from a CSV file.</li>
<li>Understand potential problems with file headers.</li>
<li>Use facets to summarize data from a column.</li>
<li>Use clustering to detect possible typing errors.</li>
<li>Understand that there are different clustering algorithms which
might give different results.</li>
<li>Employ drop-downs to remove white spaces from cells.</li>
<li>Manipulate data using previous steps with undo/redo.</li>
</ul></div>
</div>
</div>
</div>
</div>
<section id="creating-a-new-openrefine-project"><h2 class="section-heading">Creating a new OpenRefine project<a class="anchor" aria-label="anchor" href="#creating-a-new-openrefine-project"></a>
</h2>
<hr class="half-width"><p>If you have not started OpenRefine yet, follow the <a href="index.html#setup">Setup</a> instructions before continuing.</p>
<p>OpenRefine can import a variety of file types, including tab
separated (<code>tsv</code>), comma separated (<code>csv</code>), Excel
(<code>xls</code>, <code>xlsx</code>), JSON, XML, RDF as XML, and Google
Spreadsheets. See the <a href="https://docs.openrefine.org/manual/starting/#create-a-project-by-importing-data" class="external-link">OpenRefine
Create a Project by Importing Data page</a> for more information.</p>
<p>In this first step, we’ll browse our computer to the sample data file
for this lesson. In this case, we will be using data obtained from
interviews of farmers in two countries in eastern sub-Saharan Africa
(Mozambique and Tanzania). If you haven’t yet downloaded the data, see
the <a href="index.html#setup">instructions on downloading the data in
Setup</a>.</p>

<p>Once OpenRefine is launched in your browser, the left margin has
options to <code>Create Project</code>, <code>Open Project</code>, or
<code>Import Project</code>. Here we will create a new project:</p>
<ol style="list-style-type: decimal"><li><p>Click <code>Create Project</code> and select
<code>Get data from</code> <code>This Computer</code>.</p></li>
<li><p>Click <code>Choose Files</code> and select the file
<code>SAFI_openrefine.csv</code> that you downloaded in the <a href="index.html#setup">setup step</a>. Click <code>Open</code> or
double-click on the filename.</p></li>
<li><p>Click <code>Next&gt;&gt;</code> under the browse button to upload
the data into OpenRefine.</p></li>
<li><p>OpenRefine gives you a preview - a chance to show you it
understood the file. If, for example, your file was really
tab-delimited, the preview might look strange. You would then choose the
correct separator in the box shown and click <code>Update Preview</code>
(middle right). If this is the wrong file, click
<code>&lt;&lt;Start Over</code> (upper left). There are also options to
indicate whether the dataset has column headers included and whether
OpenRefine should skip a number of rows before reading the data. <img src="fig/OR_01_parse_options.png" alt="Parse Options" class="figure"></p></li>
<li><p>If all looks well, click <code>Create Project&gt;&gt;</code>
(upper right).</p></li>
</ol><p>Note that at step 1, you could upload data in a standard form from a
web address by selecting <code>Get data from</code>
<code>Web Addresses (URLs)</code>. The URLs must point to data in a file
type that OpenRefine understands, just like the types that you could
upload. Instead of downloading the dataset file as you did during <a href="index.html#setup">setup</a> and uploading it from your computer, you
could have submitted its URL here. Fully understanding this
functionality is out of scope for this lesson. The <a href="https://docs.openrefine.org/manual/starting#web-addresses-urls" class="external-link">OpenRefine
manual’s section on importing from Web addresses (URLs)</a> provides
further information.</p>
</section><section id="using-facets"><h2 class="section-heading">Using Facets<a class="anchor" aria-label="anchor" href="#using-facets"></a>
</h2>
<hr class="half-width"><p><em>Exploring data by applying multiple filters</em></p>
<p>Facets are one of the most useful features of OpenRefine and can help
both get an overview of the data in a project as well as help you bring
more consistency to the data. OpenRefine supports faceted browsing as a
mechanism for</p>
<ul><li>seeing a big picture of your data, and</li>
<li>filtering down to just the subset of rows that you want to change in
bulk.</li>
</ul><p>A ‘Facet’ groups all the like values that appear in a column, and
then allows you to filter the data by these values and edit values
across many records at the same time.</p>
<p>One type of Facet is called a ‘Text facet’. This groups all the
identical text values in a column and lists each value with the number
of records it appears in. The facet information always appears in the
left hand panel in the OpenRefine interface.</p>
<p>Here we will use faceting to look for potential errors in data entry
in the <code>village</code> column.</p>
<div id="finding-potential-errors" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="finding-potential-errors" class="callout-inner">
<h3 class="callout-title">Finding (potential) errors<a class="anchor" aria-label="anchor" href="#finding-potential-errors"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal"><li>Scroll over to the <code>village</code> column.</li>
<li>Click the down arrow and choose <code>Facet</code> &gt;
<code>Text facet</code>.</li>
<li>In the left panel, you’ll now see a box containing every unique
value in the <code>village</code> column along with a number
representing how many times that value occurs in the column.</li>
<li>Try sorting this facet by name and by count. Do you notice any
problems with the data? What are they?</li>
<li>Hover the mouse over one of the names in the <code>Facet</code>
list. You should see that you have an <code>edit</code> function
available.</li>
<li>You could use this to fix an error immediately, and OpenRefine will
ask whether you want to make the same correction to every value it finds
like that one. But OpenRefine offers even better ways to find and fix
these errors, which we’ll use instead. We’ll learn about these when we
talk about clustering.</li>
</ol></div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<ul><li>
<code>Chirdozo</code> is likely a mis-entry of
<code>Chirodzo</code>.</li>
<li>
<code>Ruca</code> is likely a mis-entry of <code>Ruaca</code>.</li>
<li>
<code>Ruaca - Nhamuenda</code> and <code>Ruaca-Nhamuenda</code>
refer to the same place (differ only by spaces around the hyphen). You
might also wonder if both of these are the same as <code>Ruaca</code>.
We will see how to correct these misspelled and mistyped entries in a
later exercise.</li>
<li>The entry <code>49</code> is almost certainly an error but you will
not be able to fix it by reference to other data.</li>
</ul></div>
</div>
</div>
</div>
<div id="interview-collection-dates" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="interview-collection-dates" class="callout-inner">
<h3 class="callout-title">Interview collection dates<a class="anchor" aria-label="anchor" href="#interview-collection-dates"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal"><li><p>Using faceting, find out how many different
<code>interview_date</code> values there are in the survey
results.</p></li>
<li><p>Is the column formatted as Text or Date?</p></li>
<li><p>Use faceting to produce a timeline display for
<code>interview_date</code>. You will need to use
<code>Edit cells</code> &gt; <code>Common transforms</code> &gt;
<code>To date</code> to convert this column to dates.</p></li>
<li><p>During what period were most of the interviews
collected?</p></li>
</ol></div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>For the column <code>interview_date</code> do <code>Facet</code> &gt;
<code>Text facet</code>. A box will appear in the left panel showing
that there are 19 unique entries in this column. By default, the column
<code>interview_date</code> is formatted as Text. You can change the
format by doing <code>Edit cells</code> &gt;
<code>Common transforms</code> &gt; <code>To date</code>.</p>
<p>Notice the the values in the column turn green. Doing
<code>Facet</code> &gt; <code>Timeline facet</code> creates a box in the
left panel that shows a histogram of the number of entries for each
date.</p>
<p>Most of the data was collected in November of 2016.</p>
</div>
</div>
</div>
</div>
<div id="other-types-of-facets" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="other-types-of-facets" class="callout-inner">
<h3 class="callout-title">Other types of Facets<a class="anchor" aria-label="anchor" href="#other-types-of-facets"></a>
</h3>
<div class="callout-content">
<p>Please see the <a href="https://openrefine.org/docs/manual/facets" class="external-link">OpenRefine Manual
section on Facets</a> for reference information on all types of
facets.</p>
<p>Besides ‘Text facets’ OpenRefine also supports several other types of
facet. These include:</p>
<ul><li>Numeric facets</li>
<li>Timeline facets (for dates)</li>
<li>Custom facets</li>
<li>Scatterplot facets</li>
</ul><p><strong>Numeric and Scatterplot facets</strong> display graphs
instead of lists of values. The numeric facet graph includes ‘drag and
drop’ controls you can use to set a start and end range to filter the
data displayed. A scatterplot facet allows you to visualise values in a
pair of numeric columns as a scatterplot, so that you can filter by
two-value combinations.</p>

<p><strong>Custom facets</strong> are a range of different types of
facets. Some of the default custom facets are:</p>
<ul><li>Word facet - this breaks down text into words and counts the number
of records each word appears in</li>
<li>Duplicates facet - this results in a binary facet of ‘true’ or
‘false’. Rows appear in the ‘true’ facet if the value in the selected
column is an exact match for a value in the same column in another
row</li>
<li>Text length facet - creates a numeric facet based on the length
(number of characters) of the text in each row for the selected column.
This can be useful for spotting incorrect or unusual data in a field
where specific lengths are expected (e.g. if the values are expected to
be years, any row with a text length more than 4 for that column is
likely to be incorrect)</li>
<li>Facet by blank - a binary facet of ‘true’ or ‘false’. Rows appear in
the ‘true’ facet if they have no data present in that column. This is
useful when looking for rows missing key data.</li>
</ul></div>
</div>
</div>
</section><section id="using-clustering-to-detect-possible-typing-errors"><h2 class="section-heading">Using clustering to detect possible typing errors<a class="anchor" aria-label="anchor" href="#using-clustering-to-detect-possible-typing-errors"></a>
</h2>
<hr class="half-width"><p>In OpenRefine, clustering means “finding groups of different values
that might be alternative representations of the same thing”. For
example, the two strings <code>New York</code> and <code>new york</code>
are very likely to refer to the same concept and just have
capitalization differences. Likewise, <code>Gödel</code> and
<code>Godel</code> probably refer to the same person. Clustering is a
very powerful tool for cleaning datasets which contain misspelled or
mistyped entries. OpenRefine has several clustering algorithms built in.
Experiment with them, and learn more about these algorithms and how they
work.</p>
<ol style="list-style-type: decimal"><li>In the <code>village</code> Text Facet we created in the step above,
click the <code>Cluster</code> button.</li>
<li>In the resulting pop-up window, you can change the
<code>Method</code> and the <code>Keying Function</code>. Try different
combinations to see what different mergers of values are suggested.</li>
<li>Select the <code>key collision</code> method and
<code>metaphone3</code> keying function. It should identify two
clusters.</li>
<li>Click the <code>Merge?</code> box beside each cluster, then click
<code>Merge Selected and Recluster</code> to apply the corrections to
the dataset.</li>
<li>Try selecting different <code>Methods</code> and
<code>Keying Functions</code> again, to see what new merges are
suggested.</li>
<li>You should find that using the default settings, no more clusters
are found, for example to merge <code>Ruaca-Nhamuenda</code> with
<code>Ruaca</code> or <code>Chirdozo</code> with <code>Chirodzo</code>.
(Note that the <code>nearest neighbor</code> method with
<code>ppm</code> distance, <code>radius</code> ≥ 4, and
<code>block chars</code> ≤ 4 will find these clusters, as well as other
settings with <code>levenshtein</code> distance)</li>
<li>To merge these values we will hover over them in the village text
facet, select edit, and manually change the names. Change
<code>Chirdozo</code> to <code>Chirodzo</code> and
<code>Ruaca-Nhamuenda</code> to <code>Ruaca</code>. You should now have
four clusters: <code>Chirodzo</code>, <code>God</code>,
<code>Ruaca</code> and <code>49</code>.</li>
</ol><p>Important: If you <code>Merge</code> using a different method or
keying function, or more times than described in the instructions above,
your solutions for later exercises will not be the same as shown in
those exercise solutions.</p>
<p>The <a href="https://openrefine.org/docs/technical-reference/clustering-in-depth" class="external-link">manual’s
section on clustering</a> provides technical details on how the
different clustering algorithms work.</p>
</section><section id="transforming-data"><h2 class="section-heading">Transforming data<a class="anchor" aria-label="anchor" href="#transforming-data"></a>
</h2>
<hr class="half-width"><p>The data in the <code>items_owned</code> column is a set of items in
a list. The list is in square brackets and each item is in single
quotes. Before we split the list into individual items in the next
section, we first want to remove the brackets and the quotes.</p>
<ol style="list-style-type: decimal"><li><p>Click the down arrow at the top of the <code>items_owned</code>
column. Choose <code>Edit Cells</code> &gt;
<code>Transform...</code></p></li>
<li><p>This will open up a window into which you can type a GREL
expression. GREL stands for General Refine Expression Language. <img src="fig/OR_02_Transform.png" alt="OR_Transform" class="figure"></p></li>
<li><p>First we will remove all of the left square brackets
(<code>[</code>). In the Expression box type
<code>value.replace("[", "")</code> and click <code>OK</code>.</p></li>
<li><p>What the expression means is this: Take the <code>value</code> in
each cell in the selected column and replace all of the “[” with “”
(i.e. nothing - delete).</p></li>
<li><p>Click <code>OK</code>. You should see in the
<code>items_owned</code> column that there are no longer any left square
brackets.</p></li>
</ol><div id="remove-unwanted-characters" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="remove-unwanted-characters" class="callout-inner">
<h3 class="callout-title">Remove unwanted characters<a class="anchor" aria-label="anchor" href="#remove-unwanted-characters"></a>
</h3>
<div class="callout-content">
<p>Use this same strategy to remove the single quote marks
(<code>'</code>), the right square brackets (<code>]</code>), and spaces
from the <code>items_owned</code> column.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<ol style="list-style-type: decimal"><li><code>value.replace("'", "")</code></li>
<li><code>value.replace("]", "")</code></li>
<li>
<code>value.replace(" ", "")</code> You should now have a list of
items separated by semi-colons (<code>;</code>).</li>
</ol></div>
</div>
</div>
</div>
<p>Now that we have cleaned out extraneous characters from our
<code>items_owned</code> column, we can use a text facet to see which
items were commonly owned or rarely owned by the interview
respondents.</p>
<ol style="list-style-type: decimal"><li>Click the down arrow at the top of the <code>items_owned</code>
column. Choose <code>Facet</code> &gt;
<code>Custom text facet...</code>
</li>
<li>In the <code>Expression</code> box, type
<code>value.split(";")</code>.</li>
<li>Click <code>OK</code>.</li>
</ol><p>You should now see a new text facet box in the left-hand pane.</p>
<div id="commonly-owned-items" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="commonly-owned-items" class="callout-inner">
<h3 class="callout-title">Commonly owned items<a class="anchor" aria-label="anchor" href="#commonly-owned-items"></a>
</h3>
<div class="callout-content">
<p>Which two items are the most commonly owned? Which are the two least
commonly owned?</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<p>Select <code>Sort by:</code> <code>count</code>. The most commonly
owned items are mobile phone and radio, the least commonly owned are
cars and computers.</p>
</div>
</div>
</div>
</div>
<div id="months-with-farmers-lacking-food" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="months-with-farmers-lacking-food" class="callout-inner">
<h3 class="callout-title">Month(s) with farmers lacking food<a class="anchor" aria-label="anchor" href="#months-with-farmers-lacking-food"></a>
</h3>
<div class="callout-content">
<p>Perform the same clean up steps and customized text faceting for the
<code>months_lack_food</code> column. Which month(s) were farmers more
likely to lack food?</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<p>All four cleaning steps can be performed by combining
<code>.replace</code> statements. The command is:
<code>value.replace("[", "").replace("]", "").replace(" ", "").replace("'", "")</code>
This can also be done in four separate steps if preferred. November was
the most common month for respondents to lack food.</p>
</div>
</div>
</div>
</div>
<div id="clean-up-other-columns" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="clean-up-other-columns" class="callout-inner">
<h3 class="callout-title">Clean up other columns<a class="anchor" aria-label="anchor" href="#clean-up-other-columns"></a>
</h3>
<div class="callout-content">
<p>Perform the same clean up steps for the <code>months_no_water</code>,
<code>liv_owned</code>, <code>res_change</code>, and
<code>no_food_mitigation</code> columns. Hint: To reuse a GREL command,
click the <code>History</code> tab and then click <code>Reuse</code>
next to the command you would like to apply to that column.</p>
</div>
</div>
</div>
</section><section id="using-undo-and-redo"><h2 class="section-heading">Using undo and redo<a class="anchor" aria-label="anchor" href="#using-undo-and-redo"></a>
</h2>
<hr class="half-width"><p>It’s common while exploring and cleaning a dataset to discover after
you’ve made a change that you really should have done something else
first. OpenRefine provides <code>Undo</code> and <code>Redo</code>
operations to make this easy.</p>
<div id="explore-undo-and-redo" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="explore-undo-and-redo" class="callout-inner">
<h3 class="callout-title">Explore undo and redo<a class="anchor" aria-label="anchor" href="#explore-undo-and-redo"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal"><li>Click where it says <code>Undo / Redo</code> on the left side of the
screen. All the changes you have made so far are listed here.</li>
<li>Click on the step that you want to go back to, in this case go back
several steps to before you had done any text transformation.</li>
<li>Visually confirm that those columns now contain the special
characters that we had removed previously.</li>
<li>Notice that you can still click on the later steps to
<code>Redo</code> the actions. Before moving on to the next lesson, redo
all the steps in your analysis so that all of the columns you modified
are lacking in square brackets, spaces, and single quotes.</li>
</ol></div>
</div>
</div>
</section><section id="trim-leading-and-trailing-whitespace"><h2 class="section-heading">Trim Leading and Trailing Whitespace<a class="anchor" aria-label="anchor" href="#trim-leading-and-trailing-whitespace"></a>
</h2>
<hr class="half-width"><p>Sometimes spaces (or tabs, or newline characters) will be present at
the beginning or end of a text cell. They may have been in the dataset
that was imported, or appear when you perform operations on the data,
such as splitting text. While we as humans cannot always see or notice
these (especially if they are at the end of a word), a computer always
sees them. These spaces are often unwanted variations that should to be
removed.</p>
<p>As of version 3.4, OpenRefine provides the option to trim
(i.e. remove) leading and trailing whitespace during the import of data
(see image at the top of this page). This is then applied to the data in
all columns.</p>
<p>OpenRefine also provides a menu option to remove blank characters
from the beginning and end of any entries in the column that you
choose.</p>
<div id="remove-a-trailing-space" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="remove-a-trailing-space" class="callout-inner">
<h3 class="callout-title">Remove a trailing space<a class="anchor" aria-label="anchor" href="#remove-a-trailing-space"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal"><li>Edit the <code>village</code> on the first row to introduce a space
at the end, set to <code>God</code>.</li>
<li>Create a new text facet for the <code>village</code> column. You
should now see two different entries for <code>God</code>, one of which
has a trailing whitespace.</li>
<li>To remove the whitespace, choose <code>Edit cells</code> &gt;
<code>Common transforms</code> &gt;
<code>Trim leading and trailing whitespace</code>.</li>
<li>You should now see only four choices in your text facet again.</li>
</ol></div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul><li>OpenRefine can import a variety of file types.</li>
<li>OpenRefine can be used to explore data using filters.</li>
<li>Clustering in OpenRefine can help to identify different values that
might mean the same thing.</li>
<li>OpenRefine can transform the values of a column.</li>
</ul></div>
</div>
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="01-introduction.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="03-filter-sort.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="01-introduction.html" rel="prev"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous: Introduction</a>
        <a class="chapter-link float-end" href="03-filter-sort.html" rel="next">Next: Filtering and... <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
				<p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/datacarpentry/openrefine-socialsci/edit/main/episodes/02-working-with-openrefine.md" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/datacarpentry/openrefine-socialsci/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a> 
        | <a href="https://github.com/datacarpentry/openrefine-socialsci/" class="external-link">Source</a></p>
				<p><a href="https://github.com/datacarpentry/openrefine-socialsci/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p><a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">Template licensed under CC-BY 4.0</a> by <a href="https://carpentries.org" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.12.3" class="external-link">sandpaper (0.12.3)</a>,
        <a href="https://github.com/carpentries/pegboard" class="external-link">pegboard (0.5.3)</a>,
      and <a href="https://github.com/carpentries/varnish/tree/0.2.17" class="external-link">varnish (0.2.17)</a>.</p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
			<i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back to top"></i><br><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://datacarpentry.org/openrefine-socialsci/02-working-with-openrefine.html",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "OpenRefine, data cleaning, data, lesson, The Carpentries",
  "name": "Working with OpenRefine",
  "creativeWorkStatus": "active",
  "url": "https://datacarpentry.org/openrefine-socialsci/02-working-with-openrefine.html",
  "identifier": "https://datacarpentry.org/openrefine-socialsci/02-working-with-openrefine.html",
  "dateCreated": "2017-05-25",
  "dateModified": "2023-06-12",
  "datePublished": "2023-06-15"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code --></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

